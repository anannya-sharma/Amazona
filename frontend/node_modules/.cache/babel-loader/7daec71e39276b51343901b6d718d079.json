{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/anann/Downloads/amazona-master/amazona-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/anann/Downloads/amazona-master/amazona-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/anann/Downloads/amazona-master/amazona-master/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import{LoadScript,GoogleMap,StandaloneSearchBox,Marker}from'@react-google-maps/api';import LoadingBox from'../components/LoadingBox';import Axios from'axios';import{USER_ADDRESS_MAP_CONFIRM}from'../constants/userConstants';import{useDispatch}from'react-redux';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var libs=['places'];var defaultLocation={lat:45.516,lng:-73.56};export default function MapScreen(props){var navigate=useNavigate();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),googleApiKey=_useState2[0],setGoogleApiKey=_useState2[1];var _useState3=useState(defaultLocation),_useState4=_slicedToArray(_useState3,2),center=_useState4[0],setCenter=_useState4[1];var _useState5=useState(center),_useState6=_slicedToArray(_useState5,2),location=_useState6[0],setLocation=_useState6[1];var mapRef=useRef(null);var placeRef=useRef(null);var markerRef=useRef(null);useEffect(function(){var fetch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Axios,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Axios('/api/config/google');case 2:_yield$Axios=_context.sent;data=_yield$Axios.data;setGoogleApiKey(data);getUserCurrentLocation();case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetch(){return _ref.apply(this,arguments);};}();fetch();},[]);var onLoad=function onLoad(map){mapRef.current=map;};var onMarkerLoad=function onMarkerLoad(marker){markerRef.current=marker;};var onLoadPlaces=function onLoadPlaces(place){placeRef.current=place;};var onIdle=function onIdle(){setLocation({lat:mapRef.current.center.lat(),lng:mapRef.current.center.lng()});};var onPlacesChanged=function onPlacesChanged(){var place=placeRef.current.getPlaces()[0].geometry.location;setCenter({lat:place.lat(),lng:place.lng()});setLocation({lat:place.lat(),lng:place.lng()});};var dispatch=useDispatch();var onConfirm=function onConfirm(){var places=placeRef.current.getPlaces();if(places&&places.length===1){// dispatch select action\ndispatch({type:USER_ADDRESS_MAP_CONFIRM,payload:{lat:location.lat,lng:location.lng,address:places[0].formatted_address,name:places[0].name,vicinity:places[0].vicinity,googleAddressId:places[0].id}});alert('location selected successfully.');navigate('/shipping');}else{alert('Please enter your address');}};var getUserCurrentLocation=function getUserCurrentLocation(){if(!navigator.geolocation){alert('Geolocation os not supported by this browser');}else{navigator.geolocation.getCurrentPosition(function(position){setCenter({lat:position.coords.latitude,lng:position.coords.longitude});setLocation({lat:position.coords.latitude,lng:position.coords.longitude});});}};return googleApiKey?/*#__PURE__*/_jsx(\"div\",{className:\"full-container\",children:/*#__PURE__*/_jsx(LoadScript,{libraries:libs,googleMapsApiKey:googleApiKey,children:/*#__PURE__*/_jsxs(GoogleMap,{id:\"smaple-map\",mapContainerStyle:{height:'100%',width:'100%'},center:center,zoom:15,onLoad:onLoad,onIdle:onIdle,children:[/*#__PURE__*/_jsx(StandaloneSearchBox,{onLoad:onLoadPlaces,onPlacesChanged:onPlacesChanged,children:/*#__PURE__*/_jsxs(\"div\",{className:\"map-input-box\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter your address\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"primary\",onClick:onConfirm,children:\"Confirm\"})]})}),/*#__PURE__*/_jsx(Marker,{position:location,onLoad:onMarkerLoad})]})})}):/*#__PURE__*/_jsx(LoadingBox,{});}","map":{"version":3,"sources":["C:/Users/anann/Downloads/amazona-master/amazona-master/frontend/src/screens/MapScreen.js"],"names":["React","useEffect","useRef","useState","LoadScript","GoogleMap","StandaloneSearchBox","Marker","LoadingBox","Axios","USER_ADDRESS_MAP_CONFIRM","useDispatch","useNavigate","libs","defaultLocation","lat","lng","MapScreen","props","navigate","googleApiKey","setGoogleApiKey","center","setCenter","location","setLocation","mapRef","placeRef","markerRef","fetch","data","getUserCurrentLocation","onLoad","map","current","onMarkerLoad","marker","onLoadPlaces","place","onIdle","onPlacesChanged","getPlaces","geometry","dispatch","onConfirm","places","length","type","payload","address","formatted_address","name","vicinity","googleAddressId","id","alert","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","height","width"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport {\n  LoadScript,\n  GoogleMap,\n  StandaloneSearchBox,\n  Marker,\n} from '@react-google-maps/api';\nimport LoadingBox from '../components/LoadingBox';\nimport Axios from 'axios';\nimport { USER_ADDRESS_MAP_CONFIRM } from '../constants/userConstants';\nimport { useDispatch } from 'react-redux';\nimport { useNavigate } from 'react-router-dom';\n\nconst libs = ['places'];\nconst defaultLocation = { lat: 45.516, lng: -73.56 };\n\nexport default function MapScreen(props) {\n  const navigate = useNavigate();\n  const [googleApiKey, setGoogleApiKey] = useState('');\n  const [center, setCenter] = useState(defaultLocation);\n  const [location, setLocation] = useState(center);\n\n  const mapRef = useRef(null);\n  const placeRef = useRef(null);\n  const markerRef = useRef(null);\n\n  useEffect(() => {\n    const fetch = async () => {\n      const { data } = await Axios('/api/config/google');\n      setGoogleApiKey(data);\n      getUserCurrentLocation();\n    };\n    fetch();\n  }, []);\n\n  const onLoad = (map) => {\n    mapRef.current = map;\n  };\n\n  const onMarkerLoad = (marker) => {\n    markerRef.current = marker;\n  };\n  const onLoadPlaces = (place) => {\n    placeRef.current = place;\n  };\n  const onIdle = () => {\n    setLocation({\n      lat: mapRef.current.center.lat(),\n      lng: mapRef.current.center.lng(),\n    });\n  };\n  const onPlacesChanged = () => {\n    const place = placeRef.current.getPlaces()[0].geometry.location;\n    setCenter({ lat: place.lat(), lng: place.lng() });\n    setLocation({ lat: place.lat(), lng: place.lng() });\n  };\n  const dispatch = useDispatch();\n  const onConfirm = () => {\n    const places = placeRef.current.getPlaces();\n    if (places && places.length === 1) {\n      // dispatch select action\n      dispatch({\n        type: USER_ADDRESS_MAP_CONFIRM,\n        payload: {\n          lat: location.lat,\n          lng: location.lng,\n          address: places[0].formatted_address,\n          name: places[0].name,\n          vicinity: places[0].vicinity,\n          googleAddressId: places[0].id,\n        },\n      });\n      alert('location selected successfully.');\n      navigate('/shipping');\n    } else {\n      alert('Please enter your address');\n    }\n  };\n\n  const getUserCurrentLocation = () => {\n    if (!navigator.geolocation) {\n      alert('Geolocation os not supported by this browser');\n    } else {\n      navigator.geolocation.getCurrentPosition((position) => {\n        setCenter({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        });\n        setLocation({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        });\n      });\n    }\n  };\n\n  return googleApiKey ? (\n    <div className=\"full-container\">\n      <LoadScript libraries={libs} googleMapsApiKey={googleApiKey}>\n        <GoogleMap\n          id=\"smaple-map\"\n          mapContainerStyle={{ height: '100%', width: '100%' }}\n          center={center}\n          zoom={15}\n          onLoad={onLoad}\n          onIdle={onIdle}\n        >\n          <StandaloneSearchBox\n            onLoad={onLoadPlaces}\n            onPlacesChanged={onPlacesChanged}\n          >\n            <div className=\"map-input-box\">\n              <input type=\"text\" placeholder=\"Enter your address\"></input>\n              <button type=\"button\" className=\"primary\" onClick={onConfirm}>\n                Confirm\n              </button>\n            </div>\n          </StandaloneSearchBox>\n          <Marker position={location} onLoad={onMarkerLoad}></Marker>\n        </GoogleMap>\n      </LoadScript>\n    </div>\n  ) : (\n    <LoadingBox></LoadingBox>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}